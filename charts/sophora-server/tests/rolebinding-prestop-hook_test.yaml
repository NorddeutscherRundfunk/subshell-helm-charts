suite: test serviceaccount
templates:
  - rolebinding-prestop-hook.yaml
tests:
  - it: should be created
    values:
      - ./values/with-sa-and-prestop.yaml
    asserts:
      - isKind:
          of: RoleBinding
  - it: should not be created
    values:
      - ./values/with-sa-and-without-prestop.yaml
    asserts:
      - hasDocuments:
          count: 0
  - it: this test fails
    values:
      - ./values/with-sa-and-without-prestop.yaml
    set:
      preStop:
        enabled: true
    asserts:
      - hasDocuments:
          count: 0